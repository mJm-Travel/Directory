<!DOCTYPE html>
<html>
<head>
  <meta property="og:locale" content="en_US" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="mJm Travel" />
<link rel="pingback" href="https://mjm-travel.freesite.host/xmlrpc.php"><link rel="icon" href="https://mjm-travel.freesite.host/wp-content/uploads/2025/03/cropped-mJm-Travel-Logo-32x32.jpeg" sizes="32x32" />
<link rel="icon" href="https://mjm-travel.freesite.host/wp-content/uploads/2025/03/cropped-mJm-Travel-Logo-192x192.jpeg" sizes="192x192" />
<link rel="apple-touch-icon" href="https://mjm-travel.freesite.host/wp-content/uploads/2025/03/cropped-mJm-Travel-Logo-180x180.jpeg" />
<meta name="msapplication-TileImage" content="https://mjm-travel.freesite.host/wp-content/uploads/2025/03/cropped-mJm-Travel-Logo-270x270.jpeg" />
  <meta charset="UTF-8">
  <title>Egypt Travel Directory</title>
  <style>
    ul { list-style-type: none; margin-left: 20px; }
    li { margin: 4px 0; }
  </style>
</head>
<body>
  <p><a href="https://mjm-travel.github.io/Directory/">üìÇ Back To Main Directory</a></p>
  <h1>üìÇ Egypt Travel Directory</h1>
  <ul id="repo-tree"></ul>

 <script>
    const repoOwner = "mJm-Travel";
    const repoName = "Directory";
    const branch = "main";

    // üîé Auto-detect folder path from current URL
    let pathParts = window.location.pathname.split("/").filter(Boolean);
    const repoIndex = pathParts.indexOf(repoName);
    const folderPath = pathParts.slice(repoIndex + 1, -1).join("/"); 
    // (-1 removes index.html)

    if (folderPath) {
      document.getElementById("page-title").textContent = "üìÇ " + folderPath + " Directory";
    }

    async function loadRepoTree() {
      const url = `https://api.github.com/repos/${repoOwner}/${repoName}/git/trees/${branch}?recursive=1`;

      try {
        const response = await fetch(url);
        const data = await response.json();
        const files = data.tree;

        // Build nested folder structure
        let root = {};
        files.forEach(item => {
          // ‚ùå exclude all index.html files
          if (item.path.split("/").pop() === "index.html") return;

          let parts = item.path.split("/");
          let current = root;
          parts.forEach((part, i) => {
            if (!current[part]) {
              current[part] = { __type: i === parts.length - 1 ? item.type : "tree" };
            }
            current = current[part];
          });
        });

        // Recursive function to build HTML list
        function buildList(obj, basePath = "") {
          let ul = document.createElement("ul");
          for (let name in obj) {
            if (name === "__type") continue;
            let li = document.createElement("li");

            if (obj[name].__type === "blob") { 
              // file
              let a = document.createElement("a");
              if (name.endsWith(".html")) {
                a.href = `https://${repoOwner}.github.io/${repoName}/${basePath}${name}`;
              } else {
                a.href = `https://github.com/${repoOwner}/${repoName}/blob/${branch}/${basePath}${name}`;
              }
              a.textContent = name;
              a.target = "_blank";
              li.appendChild(a);

            } else { 
              // folder
              li.textContent = "üìÅ " + name;
              li.appendChild(buildList(obj[name], basePath + name + "/"));
            }

            ul.appendChild(li);
          }
          return ul;
        }

        // ‚úÖ If folderPath detected ‚Üí show only that folder
        let displayRoot = root;
        if (folderPath) {
          let parts = folderPath.split("/");
          for (let p of parts) {
            if (displayRoot[p]) {
              displayRoot = displayRoot[p];
            }
          }
        }

        document.getElementById("repo-tree").appendChild(buildList(displayRoot));

      } catch (err) {
        console.error("Error loading repo tree:", err);
      }
    }

    loadRepoTree();
  </script>
</body>
</html>
