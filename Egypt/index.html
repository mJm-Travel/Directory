<!DOCTYPE html>
<html>
<head>
  <meta property="og:locale" content="en_US" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="mJm Travel" />
<link rel="pingback" href="https://mjm-travel.freesite.host/xmlrpc.php"><link rel="icon" href="https://mjm-travel.freesite.host/wp-content/uploads/2025/03/cropped-mJm-Travel-Logo-32x32.jpeg" sizes="32x32" />
<link rel="icon" href="https://mjm-travel.freesite.host/wp-content/uploads/2025/03/cropped-mJm-Travel-Logo-192x192.jpeg" sizes="192x192" />
<link rel="apple-touch-icon" href="https://mjm-travel.freesite.host/wp-content/uploads/2025/03/cropped-mJm-Travel-Logo-180x180.jpeg" />
<meta name="msapplication-TileImage" content="https://mjm-travel.freesite.host/wp-content/uploads/2025/03/cropped-mJm-Travel-Logo-270x270.jpeg" />
  <meta charset="UTF-8">
  <title>Egypt Travel Directory</title>
  <style>
    ul { list-style-type: none; margin-left: 20px; }
    li { margin: 4px 0; }
  </style>
</head>
<body>
  <p><a href="https://mjm-travel.github.io/Directory/">ğŸ“‚ Back To Main Directory</a></p>
  <h1>ğŸ“‚ Egypt Travel Directory</h1>
  <ul id="repo-tree"></ul>

  <script>
    const repoOwner = "mJm-Travel"; // ğŸ‘ˆ change this
    const repoName = "Directory";                // ğŸ‘ˆ change this
    const branch = "main"; // or "master" depending on your repo

    async function loadRepoTree() {
     // Get current URL path after repo name
let pathParts = window.location.pathname.split("/").filter(Boolean);

// Repo name is the 1st segment after domain
const repoName = "Directory"; // still set this manually
const repoIndex = pathParts.indexOf(repoName);

// Folder is whatever comes right after repo name
const folderPath = pathParts[repoIndex + 1] || "";

     const url = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${folderPath}?ref=${branch}`;


      try {
        const response = await fetch(url);
        const data = await response.json();
        const files = data.tree;

        // Build nested folder structure
        let root = {};
          files.forEach(item => {
// âœ… Exclude any index.html in root or subfolders
if (item.path.split("/").pop() === "index.html") return;

          let parts = item.path.split("/");
          let current = root;
          parts.forEach((part, i) => {
            if (!current[part]) {
              current[part] = { __type: i === parts.length - 1 ? item.type : "tree" };
            }
            current = current[part];
          });
        });

        function buildList(obj, basePath = "") {
          let ul = document.createElement("ul");
          for (let name in obj) {
            if (name === "__type") continue;
            let li = document.createElement("li");

            if (obj[name].__type === "blob") { 
              // file
             let a = document.createElement("a");

// ğŸ”¥ Always build from repo root (avoid duplicate folder names)
if (name.endsWith(".html")) {
  a.href = `https://${repoOwner}.github.io/${repoName}/${basePath}${name}`;
} else {
  a.href = `https://github.com/${repoOwner}/${repoName}/blob/${branch}/${basePath}${name}`;
}

a.textContent = name;
a.target = "_blank"; // âœ… open in new window
li.appendChild(a);

            } else { 
              // folder
              li.textContent = "ğŸ“ " + name;
              li.appendChild(buildList(obj[name], basePath + name + "/"));
            }

            ul.appendChild(li);
          }
          return ul;
        }

        document.getElementById("repo-tree").appendChild(buildList(root));

      } catch (err) {
        console.error("Error loading repo tree:", err);
      }
    }

    loadRepoTree();
  </script>
</body>
</html>
